<!-- register.component.html -->
<div class="login-container">
  <div class="content">
    <div class="form-container">
      <h2>Registrarse</h2>
      <form (ngSubmit)="onSubmit()" class="flex-form">
        <div class="form-group">
          <label for="username">Nombre de usuario:</label>
          <input type="text" id="username" name="username" [(ngModel)]="username" required>
        </div>
        <div class="form-group">
          <label for="firstName">Nombre:</label>
          <input type="text" id="firstName" name="firstName" [(ngModel)]="firstName" required>
        </div>
        <div class="form-group">
          <label for="lastName">Apellido:</label>
          <input type="text" id="lastName" name="lastName" [(ngModel)]="lastName" required>
        </div>
        <div class="form-group">
          <label for="email">Email:</label>
          <input type="email" id="email" name="email" [(ngModel)]="email" required>
        </div>
        <div class="form-group">
          <label for="password">Contraseña:</label>
          <input type="password" id="password" name="password" [(ngModel)]="password" required>
        </div>
        <div class="form-group">
          <label for="dni">DNI:</label>
          <input type="text" id="dni" name="dni" [(ngModel)]="dni" required>
        </div>

        <!-- Client-specific fields -->
        <ng-container *ngIf="isClient">
          <div class="form-group">
            <label for="continent">Continente:</label>
            <select id="continent" name="continent" [formControl]="continentControl" (change)="onContinentChange()">
              <option value="" disabled selected>Selecciona un continente</option>
              <option *ngFor="let continent of continents$ | async" [value]="continent.id">{{ continent.name }}</option>
            </select>
          </div>

          <!-- Region Dropdown -->
          <div class="form-group">
            <label for="region">Región:</label>
            <select id="region" name="region" [formControl]="regionControl" (change)="onRegionChange()">
              <option value="" disabled selected>Selecciona una región</option>
              <option *ngFor="let region of regions$ | async" [value]="region.id">{{ region.name }}</option>
            </select>
          </div>

          <!-- Country Dropdown -->
          <div class="form-group">
            <label for="country">País:</label>
            <select id="country" name="country" [formControl]="countryControl" (change)="onCountryChange()">
              <option value="" disabled selected>Selecciona un país</option>
              <option *ngFor="let country of countries$ | async" [value]="country.id">{{ country.name }}</option>
            </select>
          </div>

          <!-- Political Division Dropdown -->
          <div class="form-group">
            <label for="politicalDivision">Provincia:</label>
            <select id="politicalDivision" name="politicalDivision" [formControl]="politicalDivisionControl">
              <option value="" disabled selected>Selecciona una provincia</option>
              <option *ngFor="let politicalDivision of politicalDivisions$ | async" [value]="politicalDivision.id">{{
                politicalDivision.name }}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="address">Domicilio:</label>
            <input type="text" id="address" name="address" [(ngModel)]="address" required>
          </div>
          <div class="form-group">
            <label for="postalCode">Codigo Postal:</label>
            <input type="text" id="postalCode" name="postalCode" [(ngModel)]="postalCode" required>
          </div>
        </ng-container>

        <!-- Provider-specific fields -->
        <ng-container *ngIf="isProvider">
          <div class="form-group">
            <label for="cuit">CUIT:</label>
            <input type="text" id="cuit" name="cuit" [(ngModel)]="cuit" required>
          </div>
          <div class="form-group">
            <label for="identificationNumber">Numero Identificador:</label>
            <input type="text" id="identificationNumber" name="identificationNumber" [(ngModel)]="identificationNumber"
              required>
          </div>
        </ng-container>

        <div class="form-group">
          <label for="dateOfBirth">Fecha de nacimiento:</label>
          <input type="date" id="dateOfBirth" name="dateOfBirth" [(ngModel)]="dateOfBirth" required>
        </div>

        <!-- Switch para Proveedor -->
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="providerSwitch" [(ngModel)]="isProvider" name="isProvider"
            (change)="onSwitchChange('provider')">
          <label class="form-check-label" for="providerSwitch">Proveedor</label>
        </div>

        <!-- Switch para Cliente -->
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="clientSwitch" [(ngModel)]="isClient" name="isClient"
            (change)="onSwitchChange('client')">
          <label class="form-check-label" for="clientSwitch">Cliente</label>
        </div>

        <div class="flex flex-row justify-content-center align-items-end mt-3 mb-2 gap-3">
          <div class="flex flex-column mt-3 mb-2">
            <label class="font-bold mt-3 mb-2" for="code">Codigo de verificacion*</label>
            <input class="w-full" pInputText type="text" id="code" placeholder="Codigo de verificacion*"
              formControlName="code" />
          </div>
          <div *ngIf="!requestCode" class="flex flex-column mt-2 mb-2">
            <button pButton class="p-button-success p-button-sm mr-2" style="flex: 1" label="Solicitar codigo"
              (click)="onRequestCode()" type="button"></button>
          </div>
          <div *ngIf="requestCode" class="flex flex-column mt-2 mb-2">
            <button pButton class="p-button-success p-button-sm mr-2" style="flex: 1" label="Verificar codigo"
              type="button" (click)="onVerifyCode()"></button>
          </div>
        </div>
        <div class="button-container">
          <button type="submit" class="submit-button" [disabled]="!isCodeValid">Crear</button>
          <button routerLink="/" class="back-button">Volver</button>
        </div>
      </form>
    </div>
    <div class="image-container">
      <img src="../../assets/login.jpg" alt="Imagen de fondo">
    </div>
  </div>
</div>