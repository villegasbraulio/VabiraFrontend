<!-- register.component.html -->
<div class="login-container">
  <div class="content">
    <div class="form-container">
      <h2>Registrarse</h2>
      <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="flex-form">
        <div class="form-group">
          <label for="username">Nombre de usuario:</label>
          <input type="text" id="username" formControlName="username">
          <div *ngIf="userForm.get('username').hasError('required')">
            No ingreso un nombre de usuario o es incorrecto.
          </div>
        </div>
        <div class="form-group">
          <label for="firstName">Nombre:</label>
          <input type="text" id="firstName" formControlName="firstName">
          <div *ngIf="userForm.get('firstName').hasError('required')">
            El nombre es obligatorio.
          </div>
          <div *ngIf="userForm.get('firstName').hasError('pattern')">
            El nombre debe contener solo letras y tener al menos 4 caracteres.
          </div>
        </div>
        <div class="form-group">
          <label for="lastName">Apellido:</label>
          <input type="text" id="lastName" formControlName="lastName">
          <div *ngIf="userForm.get('lastName').hasError('required')">
            El apellido es obligatorio.
          </div>
          <div *ngIf="userForm.get('lastName').hasError('pattern')">
            El apellido debe contener solo letras y tener al menos 4 caracteres.
          </div>
        </div>
        <div class="form-group">
          <label for="email">Correo Electrónico:</label>
          <input type="email" id="email" formControlName="email">
          <div *ngIf="userForm.get('email').hasError('required')">
            El correo electrónico es obligatorio.
          </div>
          <div *ngIf="userForm.get('email').hasError('email')">
            El correo electrónico no tiene un formato válido.
          </div>
        </div>

        <div class="form-group">
          <label for="password">Contraseña:</label>
          <input type="password" id="password" formControlName="password">
          <div *ngIf="userForm.get('password').hasError('required')">
            La contraseña es obligatoria.
          </div>
          <div *ngIf="userForm.get('password').hasError('minlength')">
            La contraseña debe tener al menos {{ userForm.get('password').errors.minlength.requiredLength }} caracteres.
          </div>
          <div *ngIf="userForm.get('password').hasError('pattern')">
            La contraseña debe contener al menos una letra mayúscula, una letra minúscula, un número y un carácter
            especial.
          </div>
        </div>
        <div class="form-group">
          <label for="dni">DNI:</label>
          <input type="text" id="dni" formControlName="dni">
          <div *ngIf="userForm.get('dni').hasError('required')">
            El DNI es obligatorio.
          </div>
          <div *ngIf="userForm.get('dni').hasError('pattern')">
            El DNI debe contener entre 7 y 8 dígitos numéricos.
          </div>
        </div>

        <!-- Client-specific fields -->
        <ng-container *ngIf="isClient">
          <div class="form-group">
            <label for="continent">Continente:</label>
            <select id="continent" name="continent" [formControl]="continentControl" (change)="onContinentChange()">
              <option value="" disabled selected>Selecciona un continente</option>
              <option *ngFor="let continent of continents$ | async" [value]="continent.id">{{ continent.name }}</option>
            </select>
          </div>

          <!-- Region Dropdown -->
          <div class="form-group">
            <label for="region">Región:</label>
            <select id="region" name="region" [formControl]="regionControl" (change)="onRegionChange()">
              <option value="" disabled selected>Selecciona una región</option>
              <option *ngFor="let region of regions$ | async" [value]="region.id">{{ region.name }}</option>
            </select>
          </div>

          <!-- Country Dropdown -->
          <div class="form-group">
            <label for="country">País:</label>
            <select id="country" name="country" [formControl]="countryControl" (change)="onCountryChange()">
              <option value="" disabled selected>Selecciona un país</option>
              <option *ngFor="let country of countries$ | async" [value]="country.id">{{ country.name }}</option>
            </select>
          </div>

          <!-- Political Division Dropdown -->
          <div class="form-group">
            <label for="politicalDivision">Provincia:</label>
            <select id="politicalDivision" name="politicalDivision" [formControl]="politicalDivisionControl">
              <option value="" disabled selected>Selecciona una provincia</option>
              <option *ngFor="let politicalDivision of politicalDivisions$ | async" [value]="politicalDivision.id">{{
                politicalDivision.name }}</option>
            </select>
          </div>
          <div class="form-group">
            <label for="address">Domicilio:</label>
            <input type="text" id="address" name="address" [(ngModel)]="address" required>
          </div>
          <div class="form-group">
            <label for="postalCode">Codigo Postal:</label>
            <input type="text" id="postalCode" name="postalCode" [(ngModel)]="postalCode" required>
          </div>
        </ng-container>

        <!-- Provider-specific fields -->
        <ng-container *ngIf="isProvider">
          <div class="form-group">
            <label for="cuit">CUIT:</label>
            <input type="text" id="cuit" name="cuit" [(ngModel)]="cuit" required>
          </div>
          <div class="form-group">
            <label for="identificationNumber">Numero Identificador:</label>
            <input type="text" id="identificationNumber" name="identificationNumber" [(ngModel)]="identificationNumber"
              required>
          </div>
        </ng-container>

        <div class="form-group">
          <label for="dateOfBirth">Fecha de nacimiento:</label>
          <input type="date" id="dateOfBirth" name="dateOfBirth" [(ngModel)]="dateOfBirth" required>
        </div>

        <!-- Switch para Proveedor -->
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="providerSwitch" [(ngModel)]="isProvider" name="isProvider"
            (change)="onSwitchChange('provider')">
          <label class="form-check-label" for="providerSwitch">Proveedor</label>
        </div>

        <!-- Switch para Cliente -->
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="clientSwitch" [(ngModel)]="isClient" name="isClient"
            (change)="onSwitchChange('client')">
          <label class="form-check-label" for="clientSwitch">Cliente</label>
        </div>

        <!-- Botón de envío del formulario -->
        <div class="button-container">
          <button type="submit" class="submit-button">Crear</button>
          <button routerLink="/" class="back-button">Volver</button>
        </div>
      </form>
    </div>
    <div class="image-container">
      <img src="../../assets/login.jpg" alt="Imagen de fondo">
    </div>
  </div>
</div>